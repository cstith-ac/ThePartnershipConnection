<div *ngFor="let item of dashboardinfoS">
    <div class="col-md-12">
        <div class="row">
            <div class="col-md-11">
                <button class="btn btn-success mt-4 mb-4" (click)="refreshDashboard()">Refresh</button>
                <p id="partnerKeyWords" class="afa-text-red text-center font-italic" style="display:inline;margin-left:42%;position:absolute;margin-top:-1rem;">{{ item.partnerKeyWords }}</p>
            </div>
            <div class="col-md-1"></div>
        </div>
    </div>
    <div class="card-header" id="afa-card-header" style="padding-left: 15px;">
        <div class="row">
            <div class="col-sm-2">
                <h3 style="font-size:1.3rem;font-weight:700">
                    #<span id="customerNumber">{{ item.customerNumber }}</span>
                </h3>
            </div>
            <div class="col-sm-4">
                <span id="customerName" style="font-size:1.3rem;font-weight:700">{{ item.customerName }}</span>
            </div>
            <div class="col-sm-1">
                <span *ngIf="item.specialFlag" else non3GBlock>
                    <!-- Open Special Flag 3G Modal -->
                    <h2 class="special-flag-text" id="specialFlag">{{ item.specialFlag }}</h2>
                </span>
                <ng-template #non3GBlock>
                    <h2 class="special-flag-text" id="specialFlag">{{ item.specialFlag }}</h2>
                </ng-template>
            </div>
            <div class="col-sm-5">
                <p id="partnerKeyWords" class="afa-text-red">{{ item.partnerKeyWords }}</p>
            </div>
        </div>
    </div>
    <div class="card-body padding-left15 padding-top0 padding-bottom0">
        <div class="currentCustomerInvoiceRating-bg note-padding">
            <div class="row mt-3">
                <div class="col-sm-3">
                    <!--conditionally render customer rating-->
                    <div *ngIf="item.customerRatingValue === 0; else elseBlock">
                        <div class="customer-rating" id="customerRatingBg" [ngClass]="'ratingValueBg0'">
                            <span id="customerRating" [ngClass]="'ratingValueText0'">{{ item.customerRating }}</span>
                        </div>
                    </div>

                    <div *ngIf="item.customerRatingValue === 1;">
                        <div class="customer-rating" id="customerRatingBg" [ngClass]="'ratingValueBg1'">
                            <span id="customerRating" [ngClass]="'ratingValueText1'">{{ item.customerRating }}</span>
                        </div>
                    </div>

                    <div *ngIf="item.customerRatingValue === 2;">
                        <div class="customer-rating" id="customerRatingBg" [ngClass]="'ratingValueBg2'">
                            <span id="customerRating" [ngClass]="'ratingValueText2'">{{ item.customerRating }}</span>
                        </div>
                    </div>

                    <div *ngIf="item.customerRatingValue === 3;">
                        <div class="customer-rating" id="customerRatingBg" [ngClass]="'ratingValueBg3'">
                            <span id="customerRating" [ngClass]="'ratingValueText3'">{{ item.customerRating }}</span>
                        </div>
                    </div>

                    <ng-template #elseBlock>
                        <!-- There was an error. Please contact an administrator -->
                    </ng-template>
                    
                </div>
                <div class="col-sm-3">
                    <h3 class="rmr-text">$<span id="totalRMR">{{ item.totalRMR }}</span>/Month</h3>
                    <p id="billFrequency" class="mb-0">{{ item.billFrequency }}</p>
                    <p id="nextCycleOn"></p>
                </div>
                <div class="col-sm-3">
                    <h3 id="guaranteeStatus" class="guarantee-status-text">{{ item.guaranteeStatus }}</h3>
                </div>
                <div class="col-sm-3">
                    <button class="btn btn-primary boc-btn float-right" id="regionRelationshipContactModal" (click)="openRegionRelationshipContactModal(regionRelationshipContactContent)">
                        Relationship Manager
                    </button>
                </div>
            </div>
            <div class="row">
                <div class="col-md-8">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item list-no-border" style="padding-top:8px;padding-bottom:8px;">
                            
                            <span *ngIf="(item.invoicesArePrinted === 1) && (item.invoicesAreEmailed == 0) && (item.emailAddress == '')">Invoices are printed. No email address on file.</span>
                            <span *ngIf="(item.invoicesArePrinted === 1) && (item.invoicesAreEmailed == 0) && (item.emailAddress)">Invoices are printed. Email address on file, {{item.emailAddress}}</span>
                            <span *ngIf="(item.invoicesArePrinted === 1) && (item.invoicesAreEmailed == 1) && (item.emailAddress == '')">Invoices are printed and also sent via mail. <mark>No email address on file!</mark></span>
                            <span *ngIf="(item.invoicesArePrinted === 1) && (item.invoicesAreEmailed == 1) && (item.emailAddress)">Invoices are printed and also sent via email to {{item.emailAddress}}</span>
                            <span *ngIf="(item.invoicesArePrinted === 0) && (item.invoicesAreEmailed == 1) && (!item.emailAddress)">Invoices are sent via mail. <mark>No email address on file!</mark></span>
                            <span *ngIf="(item.invoicesArePrinted === 0) && (item.invoicesAreEmailed == 1) && (item.emailAddress)">Invoices are sent via email to {{item.emailAddress}}</span>
                            <span *ngIf="(item.invoicesArePrinted === 0) && (item.invoicesAreEmailed == 0) && (item.emailAddress)">No invoice delivery method chosen. Email address on file is {{item.emailAddress}}</span>
                        </li>
                        <li class="list-group-item list-no-border" style="padding-top:8px;padding-bottom:8px;"> <span id="autoPaymentMessage">{{ item.autoPaymentMessage }}</span> </li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <div *ngIf="item.hasSeparateSiteAddress === 'Separate Bill-to and Site Address';">
                        <div class="customer-rating" id="customerRatingBg" [ngClass]="'bill-to-address-btn'">
                            {{ item.hasSeparateSiteAddress }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="serviceInfo-bg note-padding">
            <h2 class="pl-2">Service Info</h2>
            <ul class="padding-left0 mb-0">
                <li class="list-group-item" style="padding-top:8px;padding-bottom:8px;">
                    Serviced by: <span id="servicedBy">{{ item.servicedBy }}</span> 
                    <span *ngIf="item.alternateServiceCompanyActive === 1">
                        <span id="alternateServiceCompanyActive">{{ item.alternateServiceCompanyActive }}</span>
                    </span>
                </li>
                <!-- Service Ticket - Last Service Visit -->
                <li class="list-group-item padding-left0" style="padding-top:8px;padding-bottom:8px;">
                    <a class="text-blue mx-auto mb-0" id="showTicketInfoModal" (click)="showTicketInfoModal()"> 
                        <i class="ni ni-fat-add" id="add-icon-blue"></i> 
                    </a> <span id="lastVisitInfo">{{ item.lastVisitInfo }}</span>
                </li>
                <li class="list-group-item" style="padding-top:8px;padding-bottom:8px;">The customer has had <span id="ticketsLastSixMonths">{{ item.ticketsLastSixMonths }}</span> service tickets in the last 6 months</li>
            </ul>
        </div>
    </div>
</div>
<!-- Special Flag 3G Modal --> <!--Removed per Glenn and Chris 09/09/2022 -->
<div class="modal fade" id="threeGModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" id="maxWidth-900">
        <div class="modal-content">
            <div class="modal-header pb-0 pl-2">
                <div class="col-md-12">
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body pt-0">
                <div class="card border-0">
                    <div class="card-body p-0" id="">
                        <div class="table-responsive">
                            <table class="table align-items-center" *ngFor="let item of basicUpgradeInfo">
                                <thead>
                                    <tr>
                                        <th scope="col">
                                            {{item.upgradeOptions}}
                                        </th>
                                        <th scope="col">
                                            {{item.requirements}}
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th>{{item.upgradeOption1}}</th>
                                        <th>{{item.requirement1}}</th>
                                    </tr>
                                    <tr>
                                        <th>{{item.upgradeOption2}}</th>
                                        <th>{{item.requirement2}}</th>
                                    </tr>
                                    <tr>
                                        <th>{{item.upgradeOption3}}</th>
                                        <th>{{item.requirement3}}</th>
                                    </tr>
                                    <tr>
                                        <th>{{item.upgradeOption4}}</th>
                                        <th>{{item.requirement4}}</th>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="hideTicketInfoModal" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- Service Info/Ticket Info Modal -->
<div class="modal fade" id="ticketInfoModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" id="maxWidth-900">
        <div class="modal-content" *ngFor="let item of serviceTicketInfo2">
            <div class="modal-header pb-0 pl-2">
                <div class="col-md-3">
                    <h2 class="modal-title" id="exampleModalLabel">Ticket #{{ item.ticket_Number }}</h2>
                </div>
                <div class="col-md-5">
                    <p class="modal-title">Created On: {{ item.creationDate }}</p>
                    <p class="modal-title pb-1">By: {{ item.entered_By }}</p>
                </div>
                <div class="col-md-4">
                    <p class="modal-title">Ticket Status: {{ item.ticketStatus }}</p>
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body pt-0">
                <div class="card border-0">
                    <div class="card-body p-0" id="ticketInfoContent">
                        <div class="row  pt-3">
                            <div class="col-md-3">
                                <p>System: {{ item.alarmAccount }}</p>
                            </div>
                            <div class="col-md-5">
                                <p>{{ item.system_Code }}</p>
                            </div>
                            <div class="col-md-4">
                                <p>System Status: {{ item.systemStatus }}</p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="list-style-type-none padding-left0">
                                    <p>Address: {{ item.addressLine }}</p>
                                    <p>Requested by: {{ item.requested_By }} <span class="pl-3">{{ item.requested_By_Phone | phone }}</span> </p>
                                    <p>Service performed by: {{ item.service_Company_Code }}</p>
                                    <p>Problem Code: {{ item.problem_Code }}</p>
                                    <p>Paid by Alarm Connections: {{ item.afaPayment | currency }}</p>
                                </div>
                            </div>
                            <div class="col-md-6" [style.display]="'flex'" [style.margin-top]="'auto'">
                                <div class="list-style-type-none padding-left0">
                                    <p>Resolution: {{ item.resolution_Code }}</p>
                                    <p>Paid by Customer: {{ item.customerPayment }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <h3>Customer Comments</h3>
                                <div class="afa-bg-tan note-padding">
                                    <p>{{ item.customerComments }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12 pt-3 pb-3">
                                <button class="btn btn-primary boc-btn ml-0 mb-0" (click)="openServiceTicketNotesModal()">
                                    Notes
                                </button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <h3>Last Service Note</h3>
                                <div class="afa-bg-tan note-padding">
                                    <p>{{ item.lastTicketNote }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="hideTicketInfoModal" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- Balance Of Contract Modal. Content availablity TBD -->
<div class="modal fade" id="bocModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" id="maxWidth-900">
        <div class="modal-content">
            <div class="modal-header">
                <div class="col-md-12">
                    <p>Header TBD</p>
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="card">
                    <div class="card-body" id="bocContent">
                        <div class="row">
                            <p>Coming Soon -> show the customerâ€™s balance of contract info</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="hideTicketInfoModal" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- Service Ticket Notes Modal -->
<div class="modal fade" id="serviceTicketNotesModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" id="maxWidth-900">
        <div class="modal-content">
            <div class="modal-header">
                <div class="col-md-12">
                    <p>Ticket Note</p>
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table align-items-center table-borderless">
                                <thead>
                                    <tr>
                                        <th scope="col" id="fontSize-75rem" style="margin-bottom:0">Enter Date</th>
                                        <th scope="col" id="fontSize-75rem" style="margin-bottom:0">Entered By</th>
                                        <th scope="col" id="fontSize-75rem" style="margin-bottom:0">Note</th>
                                    </tr>
                                </thead>
                                <tbody *ngFor="let item of serviceTicketNotes">
                                    <td>{{ item.enterDate }}</td>
                                    <td>{{ item.enteredBy }}</td>
                                    <td>{{ item.notes }}</td>   
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="hideServiceTicketNotesModal" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<ng-template #regionRelationshipContactContent>
    <div class="modal-header"></div>
    <div class="modal-body">
        <div class="card">
            <div class="card-header border-0 paddingBottom-14px">
                <div class="row align-items-center">
                  <div class="col">
                    <h5 class="mb-1 mt-1  headline-5">Region Relationship Contacts</h5>
                  </div>
                </div>
              </div>
              <div class="card-body">
                  <div class="row">
                    <div class="table-responsive">
                        <div *ngIf="rmid === 17">
                            <table class="table align-items-center">
                                <thead>
                                    <tr>
                                        <th scope="col">
                                            East Region (Ext 410)
                                        </th>
                                        <th scope="col"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th>RM</th>
                                        <!-- <th>{{item.rm}}</th> -->
                                        <th>{{currentRM}}</th>
                                    </tr>
                                    <tr>
                                        <th>RSM</th>
                                        <!-- <th>{{item.rsm}}</th> -->
                                        <th>{{currentRSM}}</th>
                                    </tr>
                                    <tr>
                                        <th>PSS</th>
                                        <!-- <th>{{item.pss}}</th> -->
                                        <th>{{currentPSS}}</th>
                                    </tr>
                                    <tr>
                                        <th>Ph# for Partners</th>
                                        <!-- <th>{{item.phone}}</th> -->
                                        <th>{{currentPhone}}</th>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div *ngIf="rmid === 371">
                            <table class="table align-items-center" *ngFor="let item of southEastRegionRelationshipContact">
                                <thead>
                                    <tr>
                                        <th scope="col">
                                            SouthEast Region (Ext 411)
                                        </th>
                                        <th scope="col"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th>RM</th>
                                        <!-- <th>{{item.rm}}</th> -->
                                        <th>{{currentRM}}</th>
                                    </tr>
                                    <tr>
                                        <th>RSM</th>
                                        <!-- <th>{{item.rsm}}</th> -->
                                        <th>{{currentRSM}}</th>
                                    </tr>
                                    <tr>
                                        <th>PSS</th>
                                        <!-- <th>{{item.pss}}</th> -->
                                        <th>{{currentPSS}}</th>
                                    </tr>
                                    <tr>
                                        <th>Ph# for Partners</th>
                                        <!-- <th>{{item.phone}}</th> -->
                                        <th>{{currentPhone}}</th>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div *ngIf="rmid === 448">
                            <table class="table align-items-center" *ngFor="let item of centralRegionRelationshipContact">
                                <thead>
                                    <tr>
                                        <th scope="col">
                                            West Region (Ext 412)
                                        </th>
                                        <th scope="col"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th>RM</th>
                                        <!-- <th>{{item.rm}}</th> -->
                                        <th>{{currentRM}}</th>
                                    </tr>
                                    <tr>
                                        <th>RSM</th>
                                        <!-- <th>{{item.rsm}}</th> -->
                                        <th>{{currentRSM}}</th>
                                    </tr>
                                    <tr>
                                        <th>PSS</th>
                                        <!-- <th>{{item.pss}}</th> -->
                                        <th>{{currentPSS}}</th>
                                    </tr>
                                    <tr>
                                        <th>Ph# for Partners</th>
                                        <!-- <th>{{item.phone}}</th> -->
                                        <th>{{currentPhone}}</th>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div *ngIf="rmid === 436">
                            <table class="table align-items-center" *ngFor="let item of westRegionRelationshipContact">
                                <thead>
                                    <tr>
                                        <th scope="col">
                                            West Region (Ext 413)
                                        </th>
                                        <th scope="col"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th>RM</th>
                                        <!-- <th>{{item.rm}}</th> -->
                                        <th>{{currentRM}}</th>
                                    </tr>
                                    <tr>
                                        <th>RSM</th>
                                        <!-- <th>{{item.rsm}}</th> -->
                                        <th>{{currentRSM}}</th>
                                    </tr>
                                    <tr>
                                        <th>PSS</th>
                                        <!-- <th>{{item.pss}}</th> -->
                                        <th>{{currentPSS}}</th>
                                    </tr>
                                    <tr>
                                        <th>Ph# for Partners</th>
                                        <!-- <th>{{item.phone}}</th> -->
                                        <th>{{currentPhone}}</th>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                      <!-- <div class="col-md-12 pt-2 pb-4">
                        <h4>East Region Relationship Contacts (Ext 410)</h4>
                        <h2>{{ this.rmName }}</h2>

                        <p>RM - Cara Davidson</p>
                        <p>RSM - Debbie DeAngelis</p>
                        <p>PSS - Karen Benner</p>
                        <p>Ph# for Partners: 855-839-9277</p>
                      </div>-->
                  </div>
              </div>
        </div>
    </div>
</ng-template>
<!-- Region Relationship Contact Modal -->
<div class="modal fade" id="regionRelationshipContactModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" id="maxWidth-900">
        <div class="modal-content">
            <div class="modal-header">
                <div class="col-md-12">
                    <p>Header TBD</p>
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="card">
                    <div class="card-body">
                        <div class="row">
                            <p>Coming Soon -> show regionRelationshipContactModal</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="hideTicketInfoModal" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="default" type="ball-spin-clockwise">  
    <p style="color: white">Please Wait...</p>  
</ngx-spinner>
