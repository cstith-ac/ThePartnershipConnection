<div class="container">
    <div class="row mt-5">
        <div class="col-md-6">
            <h5 class="headline-5 high-emphasis">Partner Contacts</h5>
        </div>
    </div>
    <div class="row mt-5">
        <div class="col-md-12 pl-0 mt-2">
            <form [formGroup]="partnerContactsSearchForm">
                <div class="form-group">
                    <div class="d-flex bd-highlight mb-2">
                        <div class="form-inline float-left pl-3 mr-auto">
                            <label>Search by typing a Partner Name:</label>
                            <input 
                                type="text" 
                                class="form-control ml-2"
                                [(ngModel)]="searchTerm"
                                formControlName="SearchTerm"
                                placeholder="Acme Products"
                            >
                            <!-- <input 
                                placeholder="Click clear to reset the list"
                                type="text" 
                                class="form-control ml-2" 
                                name="searchTerm" 
                                [(ngModel)]="searchTerm" 
                                formControlName="SearchTerm"
                                (input)="search($event.target.value)"
                                (change)="onChangeClearSearch($event)"
                            > -->
                            <!-- <div class="bd-highlight pl-3">
                              <button class="btn btn-secondary" (click)="clearSearch()">Clear</button>
                            </div> -->
                          </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div class="row mt-5">
        <div class="col-md-12">
            <table class="table table-striped table-responsive">
                <thead>
                    <tr>
                        <th scope="col">Partner Code<i class="fas fa-sort pl-1" (click)="onClickSortPartnerCode($event)"></i></th>
                        <th scope="col">Partner Name<i class="fas fa-sort pl-1" (click)="onClickSortPartnerName($event)"></i></th>
                        <th scope="col">Sedona Contact Email</th>
                        <th scope="col">TPC Login Exists</th>
                        <th scope="col">RM Assigned<i class="fas fa-filter pl-1" (click)="onOpenRMFilterModal(rmAssigned)"></i></th>
                        <th scope="col">Last Login</th>
                        <th scope="col">State<i class="fas fa-filter pl-1" (click)="onOpenStateFilterModal(state)"></i></th>
                        <th scope="col">Primary Contact<i class="fas fa-filter pl-1" (click)="onOpenFilterPrimaryContactModal(primaryContact)"></i></th>
                        <th scope="col">Special Notes</th>
                        <th scope="col">Alert Tags<i class="far fa-question-circle pl-1" (click)="onClickOpenReportingTagDictionary(reportingTagDictionary)"></i></th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of listPartnerContacts | filterPartnerviewlist:searchTerm | paginate: { itemsPerPage: 10, currentPage: p }">
                        <td class="hyperlink" (click)="onClickOpenPartnerLandingPage(item.partnerCode, item.sedonaContactEmail, item.partnerName)">{{ item.partnerCode }}</td>
                        <td>{{ item.partnerName }}</td>
                        <td>{{ item.sedonaContactEmail }}</td>
                        <td>{{ item.tpcLoginExists }}</td>
                        <td>{{ item.rmAssigned }}</td>
                        <td>{{ item.lastLoginOn }}</td>
                        <td>{{ item.usState }}</td>
                        <td>{{ item.primaryContact }}</td>
                        <td>
                            <i class="pl-1" (click)="openPartnerCustCareNoteModal(item.partnerCode, partnerCustCareNote)">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-headset bi-icon-xl" viewBox="0 0 16 16">
                                    <path d="M8 1a5 5 0 0 0-5 5v1h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V6a6 6 0 1 1 12 0v6a2.5 2.5 0 0 1-2.5 2.5H9.366a1 1 0 0 1-.866.5h-1a1 1 0 1 1 0-2h1a1 1 0 0 1 .866.5H11.5A1.5 1.5 0 0 0 13 12h-1a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1h1V6a5 5 0 0 0-5-5z"/>
                                </svg>
                            </i>
                            <!-- <i class="fas fa-wrench pl-2 pr-3 bi-icon" (click)="openPartnerCustCareNoteModal(item.partnerCode, partnerCustCareNote)"></i> -->
                            <i class="fas fa-wrench pl-3 pr-4 bi-icon" (click)="openPartnerServiceNoteModal(item.partnerCode, partnerServiceNote)"></i>
                            <i class="fas fa-exclamation bi-icon" (click)="openPartnerCriticalMessage(item.partnerCode, partnerCriticalMessage)"></i>
                        </td>
                        <td>{{ item.role }}</td>
                    </tr>
                </tbody>
            </table>
            <div class="mt-3">
                <pagination-controls (pageChange)="p = $event" class="text-center"></pagination-controls>
              </div>
            <!-- <ngb-pagination
                [collectionSize]="listPartnerContacts?.length"
                [(page)]="page" 
                [maxSize]="5" 
                [rotate]="true" 
                [ellipses]="false" 
                [boundaryLinks]="true"
                class="d-flex justify-content-center mt-5">
            </ngb-pagination> -->
        </div>
    </div>
</div>

<ng-template #rmAssigned let-modal>
    <div class="modal-header">
        <button class="close" aria-label="close" (click)="modal.dismiss('Cross click')">
            <span aria-label="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="card">
            <div class="card-body">
                <form [formGroup]="partnerViewListFilterForm">
                    <div class="row mb-3">
                        <div class="col">
                            <h5 class="headline-5">Regional Manager Filter</h5>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="myColumns" >
                            <div class="form-check" *ngFor="let item of rmListForTPC; let i = index">
                                <input  
                                    class="form-check-input" 
                                    type="radio" 
                                    formControlName="FilterRM"
                                    id="{{item.rmid}}"
                                    value="{{item.rmAssigned}}" 
                                    (change)="onChangeFilterRM($event)"
                                />
                                    {{item.rmAssigned}}
                        </div>
                    </div>         
                    </div>
                </form>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #state let-modal>
    <div class="modal-header">
        <button class="close" aria-label="close" (click)="modal.dismiss('Cross click')">
            <span aria-label="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="card">
            <div class="card-body">
                <form [formGroup]="partnerViewListFilterForm">
                    <div class="row mb-3">
                        <div class="col">
                            <h5 class="headline-5">State Filter</h5>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="myColumns" >
                            <div class="form-check" *ngFor="let item of tpcStateList; let i = index">
                                <input  
                                    class="form-check-input" 
                                    type="radio" 
                                    formControlName="FilterState"
                                    id="{{item.usStateID}}"
                                    value="{{item.usStateName}}" 
                                    (change)="onChangeFilterState($event)"
                                />    
                                    {{item.usStateName}}
                        </div>
                    </div>         
                  </div>
                </form>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #primaryContact let-modal>
    <div class="modal-header">
        <button class="close" aria-label="close" (click)="modal.dismiss('Cross click')">
            <span aria-label="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="card">
            <div class="card-body">
                <form [formGroup]="primaryContactFilterForm">
                    <div class="row mb-3">
                        <div class="col">
                            <h5 class="headline-5">Primary Contact Filter</h5>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="my-columns">
                            <div class="row">
                                <div class="col-md-6">
                                    <input 
                                    type="radio"
                                    formControlName="FilterPrimaryContact"
                                    id="all"
                                    value="n" 
                                    (change)="onChangeFilterPrimaryContact($event)">All Contacts
                                </div>
                                <div class="col-md-6">
                                    <input
                                    type="radio"
                                    formControlName="FilterPrimaryContact"
                                    id="primary"
                                    value="y" 
                                    (change)="onChangeFilterPrimaryContact($event)">Primary Contacts
                                </div>
                                <!-- <input 
                                    type="radio"
                                    formControlName="FilterPrimaryContact"
                                    id="all"
                                    value="n" 
                                    (change)="onChangeFilterPrimaryContact($event)">All Contacts -->
                                <!-- <input
                                    type="radio"
                                    formControlName="FilterPrimaryContact"
                                    id="primary"
                                    value="y" 
                                    (change)="onChangeFilterPrimaryContact($event)">Primary Contacts -->
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #reportingTagDictionary let-reportingTagDictionary>
    <div class="modal-header">
        <!-- <button class="close" aria-label="close" (click)="modal.dismiss('Cross click')">
            <span aria-label="true">&times;</span>
        </button> -->
    </div>
    <div class="modal-body">
        <div class="card">
            <div class="card-body">
                <form>
                    <div class="row mb-3">
                        <div class="col">
                            <h5 class="headline-5">Reporting Tag Dictionary</h5>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="my-columns">
                            <div class="rowReportingTagDictionary">
                                <div class="columnReportingTagDictionary">Owner</div>
                                <div class="columnReportingTagDictionary">Owner level reporting</div>
                                <!-- <ul class="list-group">
                                    <li class="list-group-item pl-3 pb-0 border-0">Owner <span class="pl-5"></span>Owner level reporting</li>
                                    <li class="list-group-item pl-3 pb-0 border-0">3GRep<span class="pl-5"></span>3G Reporting</li>
                                    <li class="list-group-item pl-3 pb-0 border-0">Prospect<span class="pl-5"></span>Sales opportunity alerts</li>
                                    <li class="list-group-item pl-3 pb-0 border-0">Aging<span class="pl-5"></span>Monday morning aging list</li>
                                    <li class="list-group-item pl-3 pb-0 border-0">ACHPay<span class="pl-5"></span>Remittance for ACH payments</li>
                                    <li class="list-group-item pl-3 pb-0 border-0">PHR<span class="pl-5"></span>Partner Health Reports</li>
                                    <li class="list-group-item pl-3 pb-0 border-0">DHR<span class="pl-5"></span>Partner Health Reports</li>
                                    <li class="list-group-item pl-3 pb-0 border-0">CustCare<span class="pl-5"></span>Cancellation Alerts</li>
                                    <li class="list-group-item pl-3 pb-0 border-0">Action<span class="pl-5"></span>Call to Action Report</li>
                                    <li class="list-group-item pl-3 pb-0 border-0">Skip<span class="pl-5"></span>Ignore this user for all reporting and emails.</li>
                                    <li class="list-group-item pl-3 pb-0 border-0">CanRep<span class="pl-5"></span>CanRep Reports</li>
                                </ul> -->
                            </div>
                            <div class="rowReportingTagDictionary">
                                <div class="columnReportingTagDictionary">3GRep</div>
                                <div class="columnReportingTagDictionary">3G Reporting</div>
                            </div>
                            <div class="rowReportingTagDictionary">
                                <div class="columnReportingTagDictionary">Prospect</div>
                                <div class="columnReportingTagDictionary">Sales Opportunity</div>
                            </div>
                            <div class="rowReportingTagDictionary">
                                <div class="columnReportingTagDictionary">Aging</div>
                                <div class="columnReportingTagDictionary">Monday morning aging list</div>
                            </div>
                            <div class="rowReportingTagDictionary">
                                <div class="columnReportingTagDictionary">ACHPay</div>
                                <div class="columnReportingTagDictionary">Remittance for ACH payments</div>
                            </div>
                            <div class="rowReportingTagDictionary">
                                <div class="columnReportingTagDictionary">PHR</div>
                                <div class="columnReportingTagDictionary">Partner Health Reports</div>
                            </div>
                            <div class="rowReportingTagDictionary">
                                <div class="columnReportingTagDictionary">DHR</div>
                                <div class="columnReportingTagDictionary">Partner Health Reports</div>
                            </div>
                            <div class="rowReportingTagDictionary">
                                <div class="columnReportingTagDictionary">CustCare</div>
                                <div class="columnReportingTagDictionary">Cancellation Alerts</div>
                            </div>
                            <div class="rowReportingTagDictionary">
                                <div class="columnReportingTagDictionary">Action</div>
                                <div class="columnReportingTagDictionary">Call to Action Report</div>
                            </div>
                            <div class="rowReportingTagDictionary">
                                <div class="columnReportingTagDictionary">Skip</div>
                                <div class="columnReportingTagDictionary">Ignore this user for all reporting and emails.</div>
                            </div>
                            <div class="rowReportingTagDictionary">
                                <div class="columnReportingTagDictionary">CanRep</div>
                                <div class="columnReportingTagDictionary">CanRep Reports</div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #partnerServiceNote let-modal>
    <div class="modal-header">
        <button class="close" aria-label="close" (click)="modal.dismiss('Cross click')">
            <span aria-label="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="card">
            <div class="card-header">
                <div class="row mb-3">
                    <div class="col">
                        <h5 class="headline-5 high-emphasis">Service Note</h5>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-12">
                        <p class="subtitle-2 medium-emphasis">{{ partnerCode }}</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <p class="body-2 medium-emphasis">{{ serviceNote }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #partnerCustCareNote let-modal>
    <div class="modal-header">
        <button class="close" aria-label="close" (click)="modal.dismiss('Cross click')">
            <span aria-label="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="card">
            <div class="card-header">
                <div class="row mb-3">
                    <div class="col">
                        <h5 class="headline-5 high-emphasis">Customer Care Note</h5>
                    </div>
                </div>
            </div>
            <div class="card-body">
               <div class="row">
                   <div class="col-md-12">
                       <p class="subtitle-2 medium-emphasis">{{ partnerCode }}</p>
                   </div>
               </div>
               <div class="row">
                   <div class="col-md-12">
                       <p class="body-2 medium-emphasis">
                        {{ customerCareNote }}
                       </p>
                   </div>
               </div>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #partnerCriticalMessage let-modal>
    <div class="modal-header">
        <button class="close" aria-label="close" (click)="modal.dismiss('Cross click')">
            <span aria-label="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="card">
            <div class="card-header">
                <div class="row mb-3">
                    <div class="col">
                        <h5 class="headline-5 high-emphasis">Critical Message</h5>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-12">
                        <p class="subtitle-2 medium-emphasis">{{ partnerCode }}</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <p class="body-2 medium-emphasis">{{ criticalMessage }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ng-template>

<ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="default" type="ball-spin-clockwise">  
    <p style="color: white">Please Wait...</p>  
</ngx-spinner>
