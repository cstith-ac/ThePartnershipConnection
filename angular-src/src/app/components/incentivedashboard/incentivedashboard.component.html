<div class="card">
    <div class="card-body">
        <h2>Incentive Entry</h2>
        {{incentiveEntry}}
        <form [formGroup]="incentiveEntryForm" (ngSubmit)="onSubmit(incentiveEntryForm)">
            <div class="col-md-12">
                <div class="row">
                    <div class="col-md-5">
                        <div class="form-group form-inline">
                            <label class="col-sm-2 col-form-label">Customer</label>
                            <input type="text" class="form-control col-sm-5" [(ngModel)]="customer" formControlName="Customer">
                            <span class="ml-2" (click)="searchCustomer(content)">
                                <i class="fas fa-search"></i>
                            </span>
                            <span class="pl-4" (click)="routeToNewCustomer()">
                                <i class="fas fa-plus-circle"></i>
                                New Customer
                            </span>
                        </div>
                        <div class="form-group form-inline">
                            <label class="col-sm-2 col-form-label">Site</label>
                            <div class="dropdown">
                                <select formControlName="Site" class="form-control col-sm-12" [(ngModel)]="selectedValue" (ngModelChange)="updateSystem($event)">
                                    <option *ngFor="let site of listsitesforcustomer" value="{{ site.customer_Site_id }}" [ngValue]="site.customer_Site_id">
                                        {{ site.siteName }}
                                    </option>
                                </select>
                            </div>
                            <span class="ml-2">
                                <i class="fas fa-search"></i>
                            </span>
                            <span class="pl-4" (click)="routeToNewSite()">
                                <i class="fas fa-plus-circle"></i>
                                New Site
                            </span>
                        </div>
                        <div class="form-group form-inline">
                            <label class="col-sm-2 col-form-label">System</label>
                            <div class="dropdown">
                                <select formControlName="System" class="form-control col-sm-12">
                                    <option *ngFor="let system of listSystemsForSite" value="{{ system.customer_System_id }}" [ngValue]="system.customer_System_id">
                                        {{ system.systemType }}
                                    </option>
                                </select>
                            </div>
                            <span class="ml-2">
                                <i class="fas fa-search"></i>
                            </span>
                        </div>
                        <div class="form-group form-inline form-check">
                            <label class="col-sm-2 col-form-label form-check-label">This is a new system</label>
                            <input type="checkbox" class="form-control form-check-input" [(ngModel)]="newSystem" formControlName="NewSystem">
                        </div>
                        <div class="form-group form-inline">
                            <p class="text-danger">Verify System Information!</p>
                        </div>
                        <div class="form-group form-inline">
                            <label class="col-sm-2 col-form-label">Account #</label>
                            <input type="text" class="form-control col-sm-5" [(ngModel)]="accountNumber" formControlName="AccountNumber">
                        </div>
                        <div class="form-group form-inline">
                            <label class="col-sm-2 col-form-label">Panel Type</label>
                            <div class="dropdown">
                                <select formControlName="PanelType" class="form-control col-sm-12" [(ngModel)]="panelType">
                                    <option *ngFor="let list of listpaneltypes" value="{{ list.panel_Type_Id }}" [ngValue]="list.panel_Type_Id">
                                        {{ list.panelName }}
                                    </option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group form-inline">
                            <label class="col-sm-2 col-form-label">Location</label>
                            <input type="text" class="form-control col-sm-5" [(ngModel)]="location" formControlName="Location">
                        </div>
                        <div class="form-group form-inline">
                            <label class="col-sm-2 col-form-label">Central Station</label>
                            <div class="dropdown">
                                <select formControlName="CentralStation" class="form-control col-sm-12" [(ngModel)]="centralStation">
                                    <option *ngFor="let station of listcentralstations" value="{{ station.centralStationID }}" [ngValue]="station.centralStationID">
                                        {{ station.csName }}
                                    </option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group form-inline">
                            <label class="col-sm-2 col-form-label">Additional Info</label>
                            <input type="text" class="form-control col-sm-5" [(ngModel)]="additionalInfo" formControlName="AdditionalInfo">
                        </div>
                    </div>
                    <div class="col-md-7">
                        <div class="row">
                            <div class="col-md-12">
                                <h3>
                                    Upload Documents
                                </h3>
                            </div>
                        </div>
                        <div class="row form-inline mb-3">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="col-sm-4 col-form-label pl-0">Invoice</label>
                                    <i class="fas fa-upload pr-3"></i>
                                    <input type="file" class="form-control col-sm-6" [(ngModel)]="invoiceUpload" formControlName="InvoiceUpload">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="col-sm-4 col-form-label">Subscriber Form</label>
                                    <i class="fas fa-upload pr-3"></i>
                                    <input type="file" class="form-control col-sm-6" [(ngModel)]="subscriberFormUpload" formControlName="SubscriberFormUpload">
                                </div>
                            </div>
                        </div>
                        <div class="row form-inline mb-3">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="col-sm-4 col-form-label pl-0">Site Visit</label>
                                    <i class="fas fa-upload pr-3"></i>
                                    <input type="file" class="form-control col-sm-6" [(ngModel)]="siteVisitUpload" formControlName="SiteVisitUpload">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="col-sm-5 col-form-label">Other Document</label>
                                    <i class="fas fa-upload pr-3"></i>
                                    <input type="file" class="form-control col-sm-6" [(ngModel)]="otherDocument1Upload" formControlName="OtherDocument1Upload">
                                </div>
                            </div>
                        </div>
                        <div class="row form-inline mb-3">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="col-sm-4 col-form-label pl-0">Contract</label>
                                    <i class="fas fa-upload pr-3"></i>
                                    <input type="file" class="form-control col-sm-6" [(ngModel)]="contractUpload" formControlName="ContractUpload">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="col-sm-5 col-form-label">Other Document</label>
                                    <i class="fas fa-upload pr-3"></i>
                                    <input type="file" class="form-control col-sm-6" [(ngModel)]="otherDocument2Upload" formControlName="OtherDocument2Upload"> 
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <h3>
                                    Incentive Information
                                </h3>
                            </div>
                        </div>
                        <div class="row form-inline mb-4">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="col-sm-4 col-form-label pl-0">Invoice #</label>
                                    <div class="input-group d-flex justify-content-center">
                                        <input type="text" class="form-control col-sm-10" [(ngModel)]="invoiceNumber" formControlName="InvoiceNumber">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="col-sm-3 col-form-label">Total</label>
                                    <div class="input-group d-flex justify-content-center">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <input type="text" class="form-control col-sm-8" [(ngModel)]="invoiceTotal" formControlName="InvoiceTotal">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="col-sm-3 col-form-label">Tax</label>
                                    <div class="input-group d-flex justify-content-center">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <input type="text" class="form-control col-sm-10" [(ngModel)]="tax" formControlName="Tax">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group form-inline">
                                    <label class="col-form-label pl-0">Recurring (Enter Line Items)<i class="fas fa-plus-circle pl-3" (click)="routeToRecurring()"></i></label>
                                    <div class="input-group col-sm-3 ml-auto">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <input type="text" class="form-control col-sm-6" [(ngModel)]="recurring" formControlName="Recurring">
                                    </div>
                                </div>
                                <div class="form-group form-inline">
                                    <label class="col-form-label pl-0">Equipment &amp; Materials (Enter Line Items)<i class="fas fa-plus-circle pl-3" (click)="routeToEquipMaterials()"></i></label>
                                    <div class="input-group col-sm-3 ml-auto">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <input type="text" class="form-control col-sm-6" [(ngModel)]="equipmentAndMaterials" formControlName="EquipmentAndMaterials">
                                    </div>
                                </div>
                                <div class="form-group form-inline">
                                    <label class="col-form-label pl-0">Labor Charges (Enter Line Items)<i class="fas fa-plus-circle pl-3" (click)="routeToLaborCharges()"></i></label>
                                    <div class="input-group col-sm-3 ml-auto">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <input type="text" class="form-control col-sm-6" [(ngModel)]="laborCharges" formControlName="LaborCharges">
                                    </div>
                                </div>
                                <div class="form-group form-inline">
                                    <label class="col-sm-5 col-form-label pl-0 display-contents">Line Item Subtotal</label>
                                    <div class="input-group col-sm-3 ml-auto">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <input type="text" class="form-control col-sm-6" [(ngModel)]="lineItemSubtotal" formControlName="LineItemSubtotal">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group form-inline">
                                    <label class="col-sm-3 col-form-label">Start Date</label>
                                    <input type="date" class="form-control col-sm-5" [(ngModel)]="startDate" formControlName="StartDate">
                                </div>
                                <div class="form-group form-inline">
                                    <label class="col-sm-3 col-form-label">Term</label>
                                    <input type="month" class="form-control col-sm-2 mr-3" [(ngModel)]="term" formControlName="Term">Months
                                </div>
                                <div class="form-group form-inline form-check">
                                    <label class="col-sm-5 col-form-label text-danger font-weight-bold form-check-label">Signals Tested!</label>
                                    <input type="checkbox" class="form-control form-check-input" [(ngModel)]="signalsTested" formControlName="SignalsTested">
                                </div>
                                <div class="form-group form-inline">
                                    <label class="col-sm-10 col-form-label">
                                        <small>I certify that all signals to and from the Central Station have been tested and the alarm system passed all of those tests.</small>
                                    </label>
                                </div>
                                <div class="col-md-4 offset-md-8">
                                    <div class="row justify-content-end">
                                        <button class="btn btn-primary btn-light-blue">Submit Incentive</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> 
                </div>
            </div>
        </form>
    </div>
</div>

<ng-template #content let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">Search</h4>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
        <kendo-grid
            [kendoGridBinding]="gridData"
            kendoGridSelectBy="customer_id"
            [selectedKeys]="mySelection"
            [pageSize]="20"
            [pageable]="true"
            [sortable]="true"
            [groupable]="true"
            [reorderable]="true"
            [resizable]="true"
            [height]="480"
            [columnMenu]="{ filter: true }"
        >
            <ng-template kendoGridToolbarTemplate>
                <input 
                    placeholder="Search in all columns..." 
                    kendoTextBox 
                    (input)="onFilter($event.target.value)" 
                />
                <!-- <button kendoGridExcelCommand type="button" icon="file-excel" style="float:right;">Export to Excel</button>
                <button kendoGridPDFCommand icon="file-pdf" style="float:right;">Export to PDF</button> -->
            </ng-template>
            <!-- <kendo-grid-checkbox-column
                [width]="45"
                [headerClass]="{'text-center': true}"
                [class]="{'text-center': true}"
                [resizable]="false"
                [columnMenu]="false"
            ></kendo-grid-checkbox-column> -->
            <kendo-grid-column 
                field="customer_Number" 
                title="Customer Number" 
                [width]="220"
                filter="text">
                <!-- <ng-template kendoGridCellTemplate let-dataItem>
                    <div class="customer-photo" [ngStyle]="{'background-image' : photoURL(dataItem)}"></div>
                    <div class="customer-name">{{ dataItem.customer_Number }}</div>
                </ng-template> -->
            </kendo-grid-column>
            <!-- <kendo-grid-column field="customer_Name" title="Customer Name" [width]="220">
            </kendo-grid-column> -->
            <kendo-grid-column
                field="customer_Name"
                title="Customer Name"
                [width]="100"
                [class]="{'text-center': true}"
                [resizable]="true"
                filter="text"
            >
                <!-- <ng-template kendoGridCellTemplate let-dataItem>
                    <img class="flag" [src]="flagURL(dataItem)" width="30">
                </ng-template> -->
            </kendo-grid-column>
            <kendo-grid-column
                field="customerStatus"
                title="Customer Status"
                [width]="100"
                [class]="{'text-center': true}"
                [resizable]="false"
            >
                <!-- <ng-template kendoGridCellTemplate let-dataItem>
                    <span *ngIf="dataItem.is_online === true" class="badge badge-success">Online</span>
                    <span *ngIf="dataItem.is_online === false" class="badge badge-danger">Offline</span>
                </ng-template> -->
            </kendo-grid-column>
            <kendo-grid-column
                    field="address_1"
                    title="Address 1"
                    [width]="110"
                    [resizable]="false"
                >
                    <!-- <ng-template kendoGridCellTemplate let-dataItem>
                        <kendo-rating
                            [value]="dataItem.rating"
                            [max]="5"
                        ></kendo-rating>
                    </ng-template> -->
                </kendo-grid-column>
                <kendo-grid-column
                    field="address_2"
                    title="Address 2"
                    [width]="230"
                    [resizable]="false"
                >
                    <!-- <ng-template kendoGridCellTemplate let-dataItem>
                        <kendo-sparkline type="bar"
                            [data]="dataItem.target"
                            [tooltip]="{visible: false}"
                            [transitions]="true"
                            [seriesDefaults]="{labels: {background: 'none', visible: true, format: '{0}%'}}"
                        >
                            <kendo-chart-area opacity="0" [width]="200"></kendo-chart-area>
                            <kendo-chart-value-axis>
                                <kendo-chart-value-axis-item [min]="0" [max]="130">
                                </kendo-chart-value-axis-item>
                            </kendo-chart-value-axis>
                        </kendo-sparkline>
                    </ng-template> -->
                </kendo-grid-column>
                <kendo-grid-column
                    field="address_3"
                    title="Address 3"
                    [width]="100"
                >
                    <!-- <ng-template kendoGridCellTemplate let-dataItem>
                        <span [ngClass]="{'red text-bold': dataItem.budget < 0}">{{ dataItem.budget | currency }}</span>
                    </ng-template> -->
                </kendo-grid-column>
                <kendo-grid-column field="city" title="City" [width]="130">
                </kendo-grid-column>
                <kendo-grid-column field="state" title="State" [width]="200">
                </kendo-grid-column>
                <kendo-grid-column field="zipCode" title="Zip Code" [width]="200">
                </kendo-grid-column>

            <!-- <kendo-grid-pdf fileName="Employees.pdf" [repeatHeaders]="true"></kendo-grid-pdf>
            <kendo-grid-excel fileName="Employees.xlsx"></kendo-grid-excel> -->
        </kendo-grid>

      <!-- <form>
        <div class="form-group">
          <label for="searchText">Search Text</label>
          <div class="input-group">
            <input type="email" class="form-control" placeholder="yyyy-mm-dd" name="dp" ngbDatepicker #dp="ngbDatepicker">
            <div class="input-group-append">
              <button class="btn btn-outline-secondary calendar" (click)="dp.toggle()" type="button"></button>
            </div>
          </div>
        </div>
      </form> -->
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">Save</button>
    </div>
  </ng-template>