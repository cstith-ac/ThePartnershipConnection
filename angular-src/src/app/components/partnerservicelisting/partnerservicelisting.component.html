<div class="card">
    <div class="card-body">
        <kendo-grid
            [kendoGridBinding]="gridData"
            [pageSize]="$any(foo).take"
            [skip]="$any(foo).skip"
            [sort]="$any(foo).sort"
            [filter]="$any(foo).filter"
            [sortable]="true"
            [pageable]="{
                pageSizes: [5,10,15,25,50,100,150,200]
            }"
            [filterable]="true"
            [resizable]="true"
            [pageSize]="pageSize"
            [groupable]="true"
            [columnMenu]="true"
            [selectable]="true"
            (sortChange)="sortChange($event)"
            (filterChange)="filterChange($event)"
            (selectionChange)="onOpenPartnerServiceListingModal($event, service_Ticket_Id, ticket_Number, creation_Date, problem_Code, contactName, contactPhone, acContact, sitePhone, acContactEmail, customer_Number, customer_Name, customerRMR, customer_Since, collectionQueue, cancelStatus, business_Name, comResStatus, address_1, address_2, address_3, city, state, zipCode, status3G, csAccount, systemType, panelType, centralStation, panel_Location, customerComments)"
            kendoGridSelectBy="service_Ticket_Id"
            [(selectedKeys)]="mySelection"
            #dateTime
            class="cursorPointer"
        >
            <ng-template kendoGridToolbarTemplate>
                <button
                    class="export-to-excel"
                    type="button"
                    kendoGridExcelCommand
                    icon="file-excel"
                >Export to Excel</button>
            </ng-template>
            <kendo-grid-column-group
                [title]="today"
                [autoSize]="false"
                #dateTime>
                <ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
                    <p [innerHTML]="today" class="mb-0"></p>
                </ng-template>
                <kendo-grid-column field="service_Ticket_Id" title="Service Ticket Id" [hidden]="true"></kendo-grid-column>
                <kendo-grid-column 
                    field="ticket_Number" 
                    title="Ticket Number" 
                    [style]="{color: '#ca5856'}"
                >
                </kendo-grid-column>
                <kendo-grid-column field="creation_Date" title="Created On"></kendo-grid-column>
                <kendo-grid-column field="problem_Code" title="Problem Code"></kendo-grid-column>
                <kendo-grid-column field="status3G" title="3G Status"></kendo-grid-column>
                <kendo-grid-column field="csAccount" title="Alarm Account"></kendo-grid-column>
                <kendo-grid-column field="customer_Number" title="Customer Number"></kendo-grid-column>
                <kendo-grid-column field="customer_Name" title="Customer Name"></kendo-grid-column>
                <kendo-grid-column field="address_1" title="Address 1"></kendo-grid-column>
                <kendo-grid-column field="city" title="City"></kendo-grid-column>
                <kendo-grid-column field="state" title="State"></kendo-grid-column>
                <kendo-grid-column field="zipCode" title="Zip"></kendo-grid-column>
                <kendo-grid-column field="cancelStatus" title="Cancel Status"></kendo-grid-column>
                <kendo-grid-column field="collectionQueue" title="Collection Status"></kendo-grid-column>
                <kendo-grid-column field="customerComments" title="Comments" [width]="90" [hidden]="true"></kendo-grid-column>
            </kendo-grid-column-group>
            <kendo-grid-excel fileName="partnerServiceListing" [fetchData]="allData">
            </kendo-grid-excel>
        </kendo-grid>
    </div>
</div>

<ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="default" type="ball-spin-clockwise">  
    <p style="color: white">Please Wait...</p>  
</ngx-spinner>


<!-- Partner Service Listing Details Modal -->
<div class="modal fade" id="detailsModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" id="maxWidth-1160">
        <div class="modal-content">
            <div class="modal-header pb-0 pl-2">
                <div class="col-md-12 mb-2">
                    <!-- <h2 class="modal-title" id="exampleModalLabel">Memo</h2> -->
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <!-- <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button> -->
            </div>
            <div class="modal-body pt-0">
                <div class="card p-3">
                    <div class="card-body">
                        <div class="row margin-bottomNegative120">
                            <div class="col">
                                <p class="mb-0">
                                    <span class="subtitle-2 high-emphasis">Ticket #</span> 
                                </p>
                                <p>
                                    <span class="body-2 medium-emphasis">{{ ticket_Number }}</span>
                                </p>
                            </div>
                            <div class="col">
                                <p class="mb-0">
                                    <span class="subtitle-2 high-emphasis">Created On</span>
                                </p>
                                <p>
                                    <span class="body-2 medium-emphasis">{{ creation_Date | date }}</span>
                                </p>
                            </div>
                            <div class="col">
                                <p class="mb-0">
                                    <span class="subtitle-2 high-emphasis">Problem</span>
                                </p>
                                <p>
                                    <span class="body-2 medium-emphasis">{{ problem_Code }}</span>
                                </p>
                            </div>
                            <div class="col">
                                <p class="mb-0">
                                    <span class="subtitle-2 high-emphasis">Customer Contact</span>
                                </p>
                                <p>
                                    <span class="body-2 medium-emphasis">{{ customer_Name }}</span>
                                </p>
                                <p>
                                    <span class="body-2 medium-emphasis">{{ sitePhone | phone }}</span>
                                </p>
                            </div>
                            <div class="col">
                                <div class="card">
                                    <div class="card-body">
                                        <p class="mb-0">
                                            <span class="subtitle-2 high-emphasis">Alarm Connections Contact</span>
                                        </p>
                                        <p>
                                            <span class="body-2 medium-emphasis">{{ acContact }}</span>
                                        </p>
                                        <p>
                                            <!-- <span class="body-2 medium-emphasis">{{ contactPhone | phone }}</span> -->
                                            <span class="body-2 medium-emphasis">(866) 803-1903</span>
                                        </p>
                                        <p>
                                            <span class="body-2 medium-emphasis">
                                                <a href="mailto:{{ acContactEmail }}" class="hyperlink">{{ acContactEmail }}</a>
                                            </span>
                                        </p>
                                        <button type="submit" class="btn btn-block btn-secondary" (click)="onOpenMessageModal()"><i class="fas fa-plus pr-2"></i>Message</button>
                                        <!-- <button type="submit" class="btn btn-block btn-secondary mt-4 te" (click)="onAddDocument()"><i class="fas fa-plus pr-2"></i>Upload File</button> -->
                                        
                                        <button class="btn btn-block btn-secondary mt-4" (click)="openComingSoonModal(comingSoon)" ><i class="fas fa-plus pr-2"></i>Upload File</button>
                                       
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-8">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-sm-4">
                                                <p class="mb-0">
                                                    <span class="subtitle-2 high-emphasis">Customer Information</span>
                                                </p>
                                                <p>
                                                    <span class="body-2 medium-emphasis">{{ customer_Number }} {{ customer_Name }}</span>
                                                </p>
                                                <p class="mb-0">
                                                    <span class="subtitle-2 high-emphasis text-error">{{ collectionQueue }}</span>
                                                </p>
                                                <p>
                                                    <span class="body-2 text-error medium-emphasis font-weight-bold">{{ cancelStatus }}</span>
                                                </p>
                                            </div>
                                            <div class="col-sm-4">
                                                <p class="mb-0">
                                                    <span class="subtitle-2 high-emphasis">RMR</span>
                                                </p>
                                                <p>
                                                    <span class="body-2 medium-emphasis">{{ customerRMR | currency }}</span>
                                                </p>
                                                <p>
                                                    <!-- <span class="body-2">{{ creditDate }}</span> -->
                                                </p>
                                            </div>
                                            <div class="col-sm-4">
                                                <p class="mb-0">
                                                    <span class="subtitle-2 high-emphasis">Customer Since</span>
                                                </p>
                                                <p>
                                                    <span class="body-2 medium-emphasis">{{ customer_Since | date }}</span>
                                                </p>
                                                <p>
                                                    <span class="subtitle-2 text-error high-emphasis font-weight-bold">{{ cancelStatus }}</span>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>     
                        </div>
                        <div class="row mt-2">
                            <div class="col-sm-6">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col">
                                                <p class="mb-0">
                                                    <span class="subtitle-2 high-emphasis">Site Information</span>
                                                </p>
                                                <p>
                                                    <span class="body-2 medium-emphasis">{{ business_Name }}</span>
                                                </p>
                                                <p>
                                                    <span class="body-2 medium-emphasis">{{ comResStatus }}</span>
                                                </p>
                                                <p>
                                                    <span class="body-2 medium-emphasis">{{ address_1 }} </span>
                                                </p>
                                                <p>
                                                    <span class="body-2 medium-emphasis">{{ address_2 }}</span>
                                                </p>
                                                <p>
                                                    <span class="body-2 medium-emphasis">{{ address_3 }}</span>
                                                    <span class="body-2 medium-emphasis">{{ city }}, {{ state }} {{ zipCode }}</span>
                                                </p>
                                                <p>
                                                    <span class="body-2 medium-emphasis">{{ sitePhone | phone }}</span>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col">
                                                <p>System Information</p>
                                            </div>
                                            <div class="col">
                                                <p class="subtitle-2 high-emphasis text-error">{{ status3G }}</p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col">
                                                <p class="mb-0">
                                                    <span class="subtitle-2 high-emphasis">CS Account #</span>
                                                </p>
                                                <p>
                                                    <span class="body-2 medium-emphasis">{{ csAccount }}</span>
                                                </p>
                
                                                <p class="mb-0">
                                                    <span class="subtitle-2 high-emphasis">System Type</span>
                                                </p>
                                                <p>
                                                    <span class="body-2 medium-emphasis">{{ systemType }}</span>
                                                </p>

                                                <p class="mb-0">
                                                    <span class="subtitle-2 high-emphasis">Panel Type</span>
                                                </p>
                                                <p>
                                                    <span class="body-2 medium-emphasis">{{ panelType }}</span>
                                                </p>

                                                <p class="mb-0">
                                                    <span class="subtitle-2 high-emphasis">Central Station</span>
                                                </p>
                                                <p>
                                                    <span class="body-2 medium-emphasis">{{ centralStation }}</span>
                                                </p>

                                                <p class="mb-0">
                                                    <span class="subtitle-2 high-emphasis">Panel Location</span>
                                                </p>
                                                <p>
                                                    <span class="body-2 medium-emphasis font-weight-bold">{{ panel_Location }}</span>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-lg-12">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col">
                                                <p class="subtitle-2 high-emphasis">Problem Description</p>
                                                <p>
                                                    <span class="body-2 medium-emphasis">{{ customerComments }}</span>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

<!-- Message Modal -->
<div class="modal fade" id="messageModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" id="maxWidth-900">
        <div class="modal-content">
            <div class="modal-header pb-0 pl-2">
                <div class="col-md-12 mb-2">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            </div>
            <div class="modal-body pt-0">
                <div class="card p-3">
                    <div class="card-body p-0">
                      <form [formGroup]="partnerServiceListingForm">
                        <div class="row">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="col-form-label headline-6 medium-emphasis">Memo</label>
                              <textarea 
                                formControlName="Memo"
                                class="form-control" 
                                cols="30" 
                                rows="10">
                              </textarea>
                            </div>
                            <div class="row">
                              <div class="col-md-12">
                                <button type="submit" class="btn btn-secondary" (click)="onSubmitMessage(partnerServiceListingForm);clicked = true;" [disabled]="clicked"><i class="fas fa-plus pr-2"></i>Submit</button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

<ng-template #comingSoon>
    <div class="modal-header">
        <!-- <button class="close" aria-label="close" (click)="modal.dismiss('Cross click')">
            <span aria-label="true">&times;</span>
        </button> -->
    </div>
    <div class="modal-body">
        <div class="card">
          <div class="card-header border-0 paddingBottom-14px">
            <div class="row align-items-center">
              <div class="col">
                <h5 class="mb-1 mt-1 text-center headline-5">Document Upload Coming Soon</h5>
              </div>
            </div>
          </div>
          <div class="card-body paddingTop-14px">
            <div class="row">
              <div class="col-md-12 pt-2 pb-4">
              </div>
            </div>
          </div>
        </div>
    </div>
</ng-template>
